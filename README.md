# 企业任务交接与派发系统

## 项目简介

这是一个基于 Go-Zero 框架开发的企业级任务交接与派发系统，主要用于企业内部的任务管理、人员调度、任务交接等场景。

### 核心功能

#### 1. 任务管理
- **任务创建**: 支持单部门和跨部门任务创建
- **任务派发**: 基于智能算法的自动任务派发
- **任务更新**: 任务信息、进度、状态更新
- **任务完成**: 任务完成后自动触发通知
- **任务删除**: 软删除机制，保留历史记录

#### 2. 任务节点管理
- **节点创建**: 为任务创建子节点，支持前置依赖
- **节点更新**: 更新节点详情、执行人、进度等
- **节点查询**: 获取用户相关的任务节点
- **节点删除**: 软删除，检查依赖关系

#### 3. 任务交接系统
- **交接创建**: 创建任务交接请求
- **交接审批**: 接收人审批交接请求
- **交接确认**: 确认交接完成
- **交接历史**: 查看交接记录

#### 4. 员工管理
- **员工创建**: 创建员工信息
- **员工更新**: 更新员工信息
- **员工离职**: 离职后自动处理任务交接
- **员工查询**: 分页查询员工列表

#### 5. 自动派发算法
基于多维度权重的智能派发：
- 员工完成任务完成度 (10%)
- 优先级任务节点完成率 (20%)
- 工龄 (20%)
- 总完成任务数 (10%)
- 自动添加人员数 (20%)
- 手动添加人员数 (20%)

#### 6. 通知系统
- **系统通知**: 任务分配、截止提醒、进度通知
- **邮件通知**: 高优先级任务邮件通知
- **短信通知**: 重要操作短信提醒

#### 7. 定时任务
- **截止提醒**: 任务截止时间前提醒
- **每日报告**: 每日任务进度报告
- **进度监测**: 检测进度缓慢的任务
- **离职检测**: 检测员工离职并自动处理

## 技术栈

- **Go**: 1.20+
- **Go-Zero**: 微服务框架
- **MySQL**: 数据存储
- **Redis**: 缓存和会话管理
- **RabbitMQ**: 消息队列
- **JWT**: 身份认证
- **SMTP**: 邮件服务

## 快速开始

### 环境要求

- Go 1.20+
- MySQL 8.0+
- Redis 6.0+
- RabbitMQ 3.8+ (可选)

### 安装步骤

1. **克隆项目**
```bash
git clone <repository-url>
cd task_Project
```

2. **安装依赖**
```bash
make deps
```

3. **配置数据库**
```bash
# 修改配置文件
vi task/etc/taskprojectapi.yaml

# 执行SQL初始化
make sql
```

4. **运行服务**
```bash
make run
```

### 配置文件

主要配置文件位于 `task/etc/taskprojectapi.yaml`:

```yaml
Name: taskprojectapi
Host: 0.0.0.0
Port: 8888

# MySQL配置
MySQL:
  DataSource: "root:password@tcp(localhost:3306)/task_project?charset=utf8mb4&parseTime=true&loc=Local"

# Redis配置
Redis:
  Host: "localhost"
  Port: 6379

# JWT配置
JWT:
  SecretKey: "your-secret-key"
  ExpireTime: "24h"

# 邮件配置
Email:
  Host: "smtp.qq.com"
  Port: 587
  Username: "your-email@qq.com"
```

## 项目结构

```
task_Project/
├── Makefile              # 项目构建文件
├── README.md            # 项目说明文档
├── API.md               # API接口文档
├── go.mod               # Go模块依赖
├── go.sum               # 依赖校验和
├── model/               # 数据模型层
│   ├── company/         # 公司相关模型
│   ├── task/            # 任务相关模型
│   ├── user/            # 用户相关模型
│   └── sql/             # SQL文件
├── task/                # API服务层
│   ├── internal/        # 内部代码
│   │   ├── handler/     # 请求处理器
│   │   ├── logic/       # 业务逻辑
│   │   ├── svc/         # 服务上下文
│   │   ├── middleware/  # 中间件
│   │   └── utils/       # 工具函数
│   ├── etc/             # 配置文件
│   └── task_project.api # API定义文件
└── docs/                # 文档目录
```

## 核心特性

### 1. 智能任务派发

系统根据以下因素自动派发任务:
- 员工工作负载
- 任务优先级匹配
- 技能匹配度
- 工作历史和表现
- 可分配时间

### 2. 任务交接流程

1. **创建交接**: 原执行人发起交接请求
2. **审批**: 接收人审批交接
3. **确认**: 双方确认交接完成
4. **通知**: 自动通知相关人员

### 3. 员工离职处理

当员工离职时：
1. 自动检测所有进行中的任务
2. 根据算法寻找最佳接替者
3. 创建交接记录
4. 发送通知给相关人员

### 4. 通知机制

- **实时通知**: 系统内实时推送
- **邮件通知**: 高优先级任务邮件提醒
- **短信通知**: 重要操作短信通知

## 开发指南

### 代码生成

```bash
# 生成API代码
make api

# 生成模型代码
make model

# 生成所有代码
make gen
```

### 运行测试

```bash
# 运行所有测试
make test

# 运行特定测试
cd task && go test ./internal/logic/... -v
```

### 代码格式化

```bash
make fmt
```

## API文档

详细的API文档请查看 [API.md](./API.md)

主要API包括:
- 用户认证: `/api/v1/auth`
- 任务管理: `/api/v1/task`
- 任务节点: `/api/v1/tasknode`
- 员工管理: `/api/v1/employee`
- 公司管理: `/api/v1/company`
- 部门管理: `/api/v1/department`
- 职位管理: `/api/v1/position`
- 交接管理: `/api/v1/handover`
- 通知管理: `/api/v1/notification`

## 许可证

MIT License

## 贡献

欢迎提交 Issue 和 Pull Request！



在这枚精心构筑的Logo中心，一株抽象而极富生命力的柳枝正向上生长、舒展。
它的主干并非柔弱的曲线，而是一道利落且充满张力的笔触，由底部沉稳地向上延展，
最终以昂扬的姿态刺破沉寂，象征着企业根基稳固且志向高远。
从主干旁逸斜出的，并非传统的柳叶，而是数枚被巧妙转化为流动数据块或任务节点的抽象叶片；
它们错落有致地依附着枝条，仿佛一串有序传递的信息流，正沿着清晰的脉络高效运转，精准喻示着任务从派发、执行到交接的无缝流程。
整体的线条语言简洁至极，毫无冗余，每一笔都蕴含着功能性与美感，传递出现代企业所追求的极致效率与清晰条理。
而在色彩的构想上，主调采用了一种从沉静科技蓝向生机活力绿的自然渐变——底部是深邃可靠的蓝，如同企业的技术底蕴与稳定架构；
至顶端则化为明亮的新生绿，代表着团队持续的成长与创新的活力。
这株柳枝因此不再仅仅是植物，它是一个动态的系统，一个生命的隐喻，静静诉说着：
在这个系统内，每一次任务的顺畅交接与流转，都如同光合作用般，最终滋养并推动着整个组织，向上，再向上，奔赴一场永不停歇的成长之旅。
